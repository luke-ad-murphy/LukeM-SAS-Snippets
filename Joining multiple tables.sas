proc sql;
create table stars_chars_ei as
select A.*,
	   B.seg,
	   C.Segment_3G

from stars_chars_ei as A,
	 New_tlu1.Customers_main1_test as B,
	 ASIS9.Lm_rf_segments_&month. as C

where (A.account_desc = B.account_desc)
	   AND (A.account_desc = C.account_desc);
quit;













PROC SQL;
 CREATE TABLE SS_1.LM_1046_BASE_MAY09 AS SELECT BASE_MAY09_3.account_desc,
	 BASE_MAY09_3.price_plan_desc,
	 BASE_MAY09_3.msisdn,
	 BASE_MAY09_3.device_desc_modified,
	 BASE_MAY09_3.May09_Skype,
	 BASE_MAY09_3.Jun09_Skype,
	 BASE_MAY09_3.Jul09_Skype,
	 BASE_MAY09_3.Skype_user,
	 CONTENT_200906.account_desc AS account_desc1,
	 CONTENT_200906.content_200906,
	 CONTENT_200906.content_cha_200906,
	 CONTENT_200907.content_200907,
	 CONTENT_200907.content_cha_200907,
	 DAT_200906.DAT_MB_200906,
	 DAT_200906.DAT_cha_200906,
	 DAT_200907.DAT_MB_200907,
	 DAT_200907.DAT_cha_200907,
	 MMS_200906.MMS_200906,
	 MMS_200906.MMS_cha_200906,
	 MMS_200907.MMS_200907,
	 MMS_200907.MMS_cha_200907,
	 SMS_200906.SMS_tot_evt_200906,
	 SMS_200906.SMS_otot_evt_200906,
	 SMS_200906.SMS_tot_cha_200906,
	 SMS_200906.SMS_otot_cha_200906,
	 SMS_200906.SMS_in_onnet_200906,
	 SMS_200906.SMS_in_offnet_200906,
	 SMS_200906.SMS_in_internat_200906,
	 SMS_200906.SMS_in_introam_200906,
	 SMS_200906.SMS_in_premium_200906,
	 SMS_200906.SMS_in_other_200906,
	 SMS_200906.SMS_cin_onnet_200906,
	 SMS_200906.SMS_cin_offnet_200906,
	 SMS_200906.SMS_cin_internat_200906,
	 SMS_200906.SMS_cin_introam_200906,
	 SMS_200906.SMS_cin_premium_200906,
	 SMS_200906.SMS_cin_other_200906,
	 SMS_200906.SMS_off_onnet_200906,
	 SMS_200906.SMS_off_offnet_200906,
	 SMS_200906.SMS_off_internat_200906,
	 SMS_200906.SMS_off_introam_200906,
	 SMS_200906.SMS_off_premium_200906,
	 SMS_200906.SMS_off_other_200906,
	 SMS_200906.SMS_coff_onnet_200906,
	 SMS_200906.SMS_coff_offnet_200906,
	 SMS_200906.SMS_coff_internat_200906,
	 SMS_200906.SMS_coff_introam_200906,
	 SMS_200906.SMS_coff_premium_200906,
	 SMS_200906.SMS_coff_other_200906,
	 SMS_200907.SMS_tot_evt_200907,
	 SMS_200907.SMS_otot_evt_200907,
	 SMS_200907.SMS_tot_cha_200907,
	 SMS_200907.SMS_otot_cha_200907,
	 SMS_200907.SMS_in_onnet_200907,
	 SMS_200907.SMS_in_offnet_200907,
	 SMS_200907.SMS_in_internat_200907,
	 SMS_200907.SMS_in_introam_200907,
	 SMS_200907.SMS_in_premium_200907,
	 SMS_200907.SMS_in_other_200907,
	 SMS_200907.SMS_cin_onnet_200907,
	 SMS_200907.SMS_cin_offnet_200907,
	 SMS_200907.SMS_cin_internat_200907,
	 SMS_200907.SMS_cin_introam_200907,
	 SMS_200907.SMS_cin_premium_200907,
	 SMS_200907.SMS_cin_other_200907,
	 SMS_200907.SMS_off_onnet_200907,
	 SMS_200907.SMS_off_offnet_200907,
	 SMS_200907.SMS_off_internat_200907,
	 SMS_200907.SMS_off_introam_200907,
	 SMS_200907.SMS_off_premium_200907,
	 SMS_200907.SMS_off_other_200907,
	 SMS_200907.SMS_coff_onnet_200907,
	 SMS_200907.SMS_coff_offnet_200907,
	 SMS_200907.SMS_coff_internat_200907,
	 SMS_200907.SMS_coff_introam_200907,
	 SMS_200907.SMS_coff_premium_200907,
	 SMS_200907.SMS_coff_other_200907,
	 VOICE_200906.tot_dur_200906,
	 VOICE_200906.otot_dur_200906,
	 VOICE_200906.tot_cha_200906,
	 VOICE_200906.otot_cha_200906,
	 VOICE_200906.din_onnet_200906,
	 VOICE_200906.din_offnet_200906,
	 VOICE_200906.din_DQ_200906,
	 VOICE_200906.din_landline_200906,
	 VOICE_200906.din_internat_200906,
	 VOICE_200906.din_introam_200906,
	 VOICE_200906.din_national_200906,
	 VOICE_200906.din_premium_200906,
	 VOICE_200906.din_free_200906,
	 VOICE_200906.din_other_200906,
	 VOICE_200906.din_voicemail_200906,
	 VOICE_200906.din_ckc_200906,
	 VOICE_200906.din_skype_200906,
	 VOICE_200906.doff_onnet_200906,
	 VOICE_200906.doff_offnet_200906,
	 VOICE_200906.doff_DQ_200906,
	 VOICE_200906.doff_landline_200906,
	 VOICE_200906.doff_internat_200906,
	 VOICE_200906.doff_introam_200906,
	 VOICE_200906.doff_national_200906,
	 VOICE_200906.doff_premium_200906,
	 VOICE_200906.doff_free_200906,
	 VOICE_200906.doff_other_200906,
	 VOICE_200906.doff_voicemail_200906,
	 VOICE_200906.doff_ckc_200906,
	 VOICE_200906.doff_skype_200906,
	 VOICE_200906.cin_onnet_200906,
	 VOICE_200906.cin_offnet_200906,
	 VOICE_200906.cin_DQ_200906,
	 VOICE_200906.cin_landline_200906,
	 VOICE_200906.cin_internat_200906,
	 VOICE_200906.cin_introam_200906,
	 VOICE_200906.cin_national_200906,
	 VOICE_200906.cin_premium_200906,
	 VOICE_200906.cin_free_200906,
	 VOICE_200906.cin_other_200906,
	 VOICE_200906.cin_voicemail_200906,
	 VOICE_200906.cin_ckc_200906,
	 VOICE_200906.cin_skype_200906,
	 VOICE_200906.coff_onnet_200906,
	 VOICE_200906.coff_offnet_200906,
	 VOICE_200906.coff_DQ_200906,
	 VOICE_200906.coff_landline_200906,
	 VOICE_200906.coff_internat_200906,
	 VOICE_200906.coff_introam_200906,
	 VOICE_200906.coff_national_200906,
	 VOICE_200906.coff_premium_200906,
	 VOICE_200906.coff_free_200906,
	 VOICE_200906.coff_other_200906,
	 VOICE_200906.coff_voicemail_200906,
	 VOICE_200906.coff_ckc_200906,
	 VOICE_200906.coff_skype_200906,
	 VOICE_200907.tot_dur_200907,
	 VOICE_200907.otot_dur_200907,
	 VOICE_200907.tot_cha_200907,
	 VOICE_200907.otot_cha_200907,
	 VOICE_200907.din_onnet_200907,
	 VOICE_200907.din_offnet_200907,
	 VOICE_200907.din_DQ_200907,
	 VOICE_200907.din_landline_200907,
	 VOICE_200907.din_internat_200907,
	 VOICE_200907.din_introam_200907,
	 VOICE_200907.din_national_200907,
	 VOICE_200907.din_premium_200907,
	 VOICE_200907.din_free_200907,
	 VOICE_200907.din_other_200907,
	 VOICE_200907.din_voicemail_200907,
	 VOICE_200907.din_ckc_200907,
	 VOICE_200907.din_skype_200907,
	 VOICE_200907.doff_onnet_200907,
	 VOICE_200907.doff_offnet_200907,
	 VOICE_200907.doff_DQ_200907,
	 VOICE_200907.doff_landline_200907,
	 VOICE_200907.doff_internat_200907,
	 VOICE_200907.doff_introam_200907,
	 VOICE_200907.doff_national_200907,
	 VOICE_200907.doff_premium_200907,
	 VOICE_200907.doff_free_200907,
	 VOICE_200907.doff_other_200907,
	 VOICE_200907.doff_voicemail_200907,
	 VOICE_200907.doff_ckc_200907,
	 VOICE_200907.doff_skype_200907,
	 VOICE_200907.cin_onnet_200907,
	 VOICE_200907.cin_offnet_200907,
	 VOICE_200907.cin_DQ_200907,
	 VOICE_200907.cin_landline_200907,
	 VOICE_200907.cin_internat_200907,
	 VOICE_200907.cin_introam_200907,
	 VOICE_200907.cin_national_200907,
	 VOICE_200907.cin_premium_200907,
	 VOICE_200907.cin_free_200907,
	 VOICE_200907.cin_other_200907,
	 VOICE_200907.cin_voicemail_200907,
	 VOICE_200907.cin_ckc_200907,
	 VOICE_200907.cin_skype_200907,
	 VOICE_200907.coff_onnet_200907,
	 VOICE_200907.coff_offnet_200907,
	 VOICE_200907.coff_DQ_200907,
	 VOICE_200907.coff_landline_200907,
	 VOICE_200907.coff_internat_200907,
	 VOICE_200907.coff_introam_200907,
	 VOICE_200907.coff_national_200907,
	 VOICE_200907.coff_premium_200907,
	 VOICE_200907.coff_free_200907,
	 VOICE_200907.coff_other_200907,
	 VOICE_200907.coff_voicemail_200907,
	 VOICE_200907.coff_ckc_200907,
	 VOICE_200907.coff_skype_200907,
	 CONSOLIDATED_MARGINS_200906.pre_promo_margin AS Margin_200906,
	 CONSOLIDATED_MARGINS_200907.pre_promo_margin AS Margin_200907 
 FROM WORK.BASE_MAY09_3 AS BASE_MAY09_3 
	  LEFT JOIN WORK.CONTENT_200906 AS CONTENT_200906 ON (BASE_MAY09_3.account_desc = CONTENT_200906.account_desc) 
	    LEFT JOIN WORK.CONTENT_200907 AS CONTENT_200907 ON (BASE_MAY09_3.account_desc = CONTENT_200907.account_desc) 
	      LEFT JOIN WORK.DAT_200906 AS DAT_200906 ON (BASE_MAY09_3.account_desc = DAT_200906.account_desc) 
	        LEFT JOIN WORK.DAT_200907 AS DAT_200907 ON (BASE_MAY09_3.account_desc = DAT_200907.account_desc) 
	          LEFT JOIN WORK.MMS_200906 AS MMS_200906 ON (BASE_MAY09_3.account_desc = MMS_200906.account_desc) 
	            LEFT JOIN WORK.MMS_200907 AS MMS_200907 ON (BASE_MAY09_3.account_desc = MMS_200907.account_desc) 
	              LEFT JOIN WORK.SMS_200906 AS SMS_200906 ON (BASE_MAY09_3.account_desc = SMS_200906.account_desc) 
	                LEFT JOIN WORK.SMS_200907 AS SMS_200907 ON (BASE_MAY09_3.account_desc = SMS_200907.account_desc) 
	                  LEFT JOIN WORK.VOICE_200906 AS VOICE_200906 ON (BASE_MAY09_3.account_desc = VOICE_200906.account_desc) 
	                    LEFT JOIN WORK.VOICE_200907 AS VOICE_200907 ON (BASE_MAY09_3.account_desc = VOICE_200907.account_desc) 
	                      LEFT JOIN MARGIN.CONSOLIDATED_MARGINS_200906 AS CONSOLIDATED_MARGINS_200906 ON (BASE_MAY09_3.account_desc = CONSOLIDATED_MARGINS_200906.account_name) 
	                        LEFT JOIN MARGIN.CONSOLIDATED_MARGINS_200907 AS CONSOLIDATED_MARGINS_200907 ON (BASE_MAY09_3.account_desc = CONSOLIDATED_MARGINS_200907.account_name);
QUIT;
